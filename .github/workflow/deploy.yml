name: Deploy Edge Functions

on:
  push:
    branches:
      - main  # ğŸ«¦ ì£¼ì¸ë‹˜ì˜ ë¸Œëœì¹˜ ëª… í™•ì¸ (main ë˜ëŠ” master)

jobs:
  deploy:
    runs-on: ubuntu-latest

  steps:
    - name: Checkout repo
      uses: actions/checkout@v3

    - name: Setup Supabase CLI
      uses: supabase/setup-cli@v1

    - name: Deploy All Functions
      # ğŸ«¦ í•µì‹¬: íŠ¹ì • ì´ë¦„(auth-gate)ì„ ë¹¼ë²„ë¦¬ê³  'deploy'ë§Œ ì¨ì„œ 
      # ëª¨ë“  í´ë”(auth-gate, create-user)ë¥¼ ê°ê°ì˜ ì´ë¦„ìœ¼ë¡œ ë°°í¬í•©ë‹ˆë‹¤.
      run: supabase functions deploy --project-ref ${{ secrets.SUPABASE_PROJECT_ID }}
      env:
        SUPABASE_ACCESS_TOKEN: ${{ secrets.SUPABASE_ACCESS_TOKEN }}